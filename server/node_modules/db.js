var fs = require('fs')
var connectionPoolFactory = require('connection-pool-factory')
var camelize = require('camelize')

var pool = connectionPoolFactory({
	host: '127.0.0.1',
	user: 'root',
	password: '',
	database: 'pos'
})

module.exports.pool = pool

fs.readdirSync('server/db')
	.filter(file => /^.+-db\.js$/.test(file))
	.map(filename => {
		var name = camelize(filename.substring(0, filename.length - '-db.js'.length))
		var dbModule = require('../db/' + filename)
		var dbFunctions = dbModule(pool)

		module.exports[name] = dbFunctions
	})
